---
title: "SOC Part 2 - Snort"
date: 2025-12-05 11:18:08 -0600
categories: [security]
tags: [projects, security, soc, snort]
---


## Prerequisites
* A fresh Ubuntu Server 24.04 installation
* Basic knowledge of Linux command-line interface
* Root access to the Linux system
* Snort3 already installed from source ([see Part 1](https://seanclosson.github.io/posts/SOC-Part-1/)) on your system , but not yet configured

## Step 1: Create a New Configuration File
Create a new file called `/etc/snort/snort.lua` using your preferred text editor. This will be where you configure all of Snort3's settings.

```
sudo mkdir /etc/snort /etc/snort/rules
sudo vi /etc/snort/snort.lua
```

## Step 2: Add a Basic Configuration
Inside the `/etc/snort/snort.lua` file, add the following lines as a base configuration:

```
HOME_NET = '192.168.1.0/24'
RULE_PATH = '/etc/snort/rules'
include(RULE_PATH .. '/local.rules')
```
* Replace the network address with your subnet.
* Save and close

## Step 3: Add a Simple Test Rule
Add the following line inside the `/etc/snort/rules/local.rules` file to enable a simple rule you can use to verify functionality:

```
alert icmp any any -> $HOME_NET any (msg:"ICMP test detected"; sid:1000001; rev:1;)
```
This will alert when a ping is detected.

## Step 4: Run Snort with Test Rule

```
sudo snort -c /etc/snort/snort.lua -i enp0s3 -A alert_fast
```
This runs Snort, listening on the enp0s3 interface (change as needed) and loads the basic rule you created . You can add or remove rulesets as needed.


## Step 8: Restart Snort3
Restart Snort3 using the following command to apply any changes you made to the configuration file:

```sudo service snort3 restart```

After configuring Snort3 and restarting it, verify that your system is properly protected by monitoring network traffic with tools like tcpdump or Wireshark.
