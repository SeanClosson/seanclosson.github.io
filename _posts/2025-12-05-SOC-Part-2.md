---
title: "SOC Part 2 - Snort"
date: 2025-12-05 11:18:08 -0600
categories: [security]
tags: [projects, security, soc, snort]
---


## Prerequisites
* A fresh Ubuntu Server 24.04 installation
* Basic knowledge of Linux command-line interface
* Root access to the Linux system
* Snort3 already installed from source ([see Part 1](https://seanclosson.github.io/posts/SOC-Part-1/)) on your system , but not yet configured

## Step 1: Create a New Configuration File
Create a new file called `/etc/snort3/snort.conf` using your preferred text editor. This will be where you configure all of Snort3's settings.

`sudo vi /etc/snort3/snort.conf`

## Step 2: Define Logging Parameters
Inside the `/etc/snort3/snort.conf` file, add the following lines to configure logging parameters:

```
logging on
logging host localhost port 514 protocol udp
logging action drop
```
These settings will log any events that occur while Snort3 is running and send them to a local host or network interface specified by host and port. The protocol parameter specifies whether to use UDP or TCP for logging, and the action parameter determines what happens to logged messages.

## Step 3: Enable Ruleset Preprocessor
Add the following lines inside the `/etc/snort3/snort.conf` file to enable the ruleset preprocessor:

```
ruleset preprocessor include /usr/share/snort3/ruleset/preprocessor.rules
```
This enables Snort3's built-in preprocessor that loads additional rulesets and performs preprocessing on any loaded rulesets.

## Step 4: Load Standard Rulesets
Add the following lines inside the `/etc/snort3/snort.conf` file to load standard rulesets:

```
ruleset ruleset include /usr/share/snort3/ruleset/standard.rules
```
This loads the default set of rules provided by Snort3. You can add or remove rulesets as needed.

## Step 5: Configure HTTP and HTTPS Ports
Add the following lines inside the `/etc/snort3/snort.conf` file to configure HTTP and HTTPS ports:
```
# Configure the HTTP port
http_port 80

# Configure the HTTPS port
https_port 443
```
These settings specify which ports Snort3 will listen on for HTTP and HTTPS traffic.

## Step 6: Enable Packet Capture
Add the following line inside the `/etc/snort3/snort.conf` file to enable packet capture:
```
# Enable packet capture for Snort3
pcap enable on
```
This enables Snort3's network interface to capture packets that match its rulesets.

## Step 7: Create service file
Add the following lines to /etc/systemd/system/snort3.service:
```bash
[Unit]
Description=Snort3 Firewall Intrusion Detection System
After=network.target

[Service]
Restart=always
ExecStart=/usr/local/bin/snort -c /etc/snort/snort.conf -i enp0s3
ExecReload=/usr/local/bin/snort -c /etc/snort/snort.conf -i enp0s3
User=www-data
Group=www-data

[Install]
WantedBy=multi-user.target
```

## Step 8: Restart Snort3
Restart Snort3 using the following command to apply any changes you made to the configuration file:

```sudo service snort3 restart```

After configuring Snort3 and restarting it, verify that your system is properly protected by monitoring network traffic with tools like tcpdump or Wireshark.
